<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="pt">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Arrumar Dados SISMA • sismar</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Arrumar Dados SISMA">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sismar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Referência</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-artigos" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Artigos</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-artigos">
<li><a class="dropdown-item" href="../articles/export-sisma.html">Exportar dados SISMA</a></li>
    <li><a class="dropdown-item" href="../articles/tidy_sop.html">Arrumar dados SISMA</a></li>
    <li><a class="dropdown-item" href="../articles/tidy-disa.html">Arrumar dados DISA</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-outro" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Outro</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-outro">
<li><a class="external-link dropdown-item" href="https://sisma.misau.gov.mz/prod/dhis-web-commons/security/login.action">Portal SISMA</a></li>
    <li><a class="external-link dropdown-item" href="https://helpdeskmoz.sis.org.mz/portal/pt/kb/sesp-epts/documenta%C3%A7%C3%A3o-de-desenvolvimento/requisitos-do-sistema-especifica%C3%A7%C3%B5es">Elementos de Dados sismar</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/usaid-mozambique/sismar"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Arrumar Dados SISMA</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/usaid-mozambique/sismar/blob/master/vignettes/tidy_sop.Rmd" class="external-link"><code>vignettes/tidy_sop.Rmd</code></a></small>
      <div class="d-none name"><code>tidy_sop.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="abrir-o-rstudio-e-carregar-os-pacotes">Abrir o RStudio e carregar os pacotes<a class="anchor" aria-label="anchor" href="#abrir-o-rstudio-e-carregar-os-pacotes"></a>
</h2>
<p>Comecemos por abrir uma nova sessão de trabalho do RStudio. Uma vez
aberta a sessão, crie um novo script R (File -&gt; New File -&gt; R
script) e carregue os principais pacotes R necessários para arrumar as
exportações .csv do SISMA. O <code>tidyverse</code> é uma coleção de
pacotes de código aberto concebidos para utilização geral em ciência de
dados. O <code>sismar</code> é um pacote desenvolvido com o objetivo
específico de efectuar a limpeza e a engenharia de caraterísticas das
exportações do SISMA. Por último, os pacotes <code>glue</code> fornecem
funções que nos permitem combinar e utilizar valores de cadeia de
caracteres no código.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://usaid-mozambique.github.io/sismar/">sismar</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glue.tidyverse.org/" class="external-link">glue</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="definir-variáveis-globais">Definir variáveis globais<a class="anchor" aria-label="anchor" href="#definir-vari%C3%A1veis-globais"></a>
</h2>
<p>Começaremos a nossa aventura codificando três valores no nosso
ambiente global para utilização posterior - 1) o ano civil para o qual
os dados foram descarregados do SISMA; 2) o caminho para a exportação
.csv do SISMA guardada na nossa máquina local; e 3) o caminho e o nome
do ficheiro onde o nosso conjunto de dados processados será guardado.
Note que a melhor prática é armazenar dados e scripts em estruturas de
pastas específicas de projectos R pré-criados. Isto facilita a
reprodutibilidade e a colaboração entre utilizadores.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">year</span> <span class="op">&lt;-</span> <span class="st">"2024"</span></span>
<span><span class="va">path_hiv_tarv</span> <span class="op">&lt;-</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"Data/tarv_{year}.csv"</span><span class="op">)</span></span>
<span><span class="va">output_hiv_tarv</span> <span class="op">&lt;-</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"Dataout/hiv_tarv_{year}.txt"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">path_hiv_tarv</span></span>
<span><span class="co">#&gt; Data/tarv_2024.csv</span></span>
<span><span class="va">output_hiv_tarv</span></span>
<span><span class="co">#&gt; Dataout/hiv_tarv_2024.txt</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="arrumar-dados-do-sisma">Arrumar dados do SISMA<a class="anchor" aria-label="anchor" href="#arrumar-dados-do-sisma"></a>
</h2>
<p>Tendo definido o caminho local para o nosso conjunto de dados SISMA,
podemos agora chamar funções do pacote sismar para gerar um quadro de
dados analítico arrumado. Isto pode ser feito utilizando uma combinação
de funções sismar chamadas em sequência ou chamando uma função “wrapper”
singular especificando os argumentos apropriados, ou finalmente usando
uma função individual que automaticamente reconhece o tipo de ficheiro
insumo sendo introduzido pelo utilizador (abordagem recomendada).
Comecemos por uma descrição da primeira abordagem.</p>
<div class="section level5">
<h5 id="abordagem-1-using-sequential-functions">Abordagem 1: Using Sequential Functions<a class="anchor" aria-label="anchor" href="#abordagem-1-using-sequential-functions"></a>
</h5>
<p>Começaremos chamando <code>clean_sisma_csv</code> e fornecendo o
argumento da função que especifica onde nossa exportação SISMA .csv
baixada é salva em nossa máquina local. Observe que essa função não
depende do tipo de dados do programa contidos no arquivo .csv. Isso
significa que <code>clean_sisma_csv</code> pode ser usado com qualquer
download tabular do SISMA. No resultado, repare que os indicadores do
quadro de dados foram “pivotados” para um formato longo, que alguns
variáveis foram removidos, e que os nomes dos indicadores foram
ligerament alterados para serem mais legíveis.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clean_sisma_csv.html">clean_sisma_csv</a></span><span class="op">(</span><span class="va">path_hiv_tarv</span><span class="op">)</span></span></code></pre></div>
<p>Em seguida, chamaremos uma função sismar para criar caraterísticas de
dados que são codificadas nos nomes de indicadores criados por
<code>clean_sisma_csv</code>. Neste caso de uso, chamamos
<code>parse_sisma_hiv_tarv</code>. É importante notar que existem vários
tipos de conjuntos de dados programáticos padrão que podem ser gerados
através de relatórios SISMA guardados. Isto significa que a função
específica de análise do sismar chamada para a engenharia de
caraterísticas varia consoante o tipo de conjunto de dados programáticos
fornecido pelo utilizador. A lista completa e a descrição de cada função
de análise do sismar são fornecidas na secção <code>sismar</code> <a href="https://usaid-mozambique.github.io/sismar/reference/index.html">package
documentation</a>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parse_sisma_hiv_tarv.html">parse_sisma_hiv_tarv</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<p>No resultado da função de análise, repare que foram adicionadas novas
variáveis ao quadro de dados e que os nomes dos indicadores foram
codificados para serem mais sucintos. Este formato organizado é perfeito
para análise!</p>
</div>
<div class="section level5">
<h5 id="abordagem-2-utilização-da-função-wrapper">Abordagem 2: Utilização da função “wrapper”<a class="anchor" aria-label="anchor" href="#abordagem-2-utiliza%C3%A7%C3%A3o-da-fun%C3%A7%C3%A3o-wrapper"></a>
</h5>
<p>Como alternativa à abordagem 1, o sismar também fornece uma função
wrapper que utiliza tanto <code>clean_sisma_csv</code> assim como
<code>parse_sisma_hiv_tarv</code> (ou uma função de análise semelhante
especificada pelo utilizador). Isso reduz a quantidade de digitação e
código necessário para produzir nosso producto final. Nesta abordagem,
nós simplesmente chamamos <code>process_sisma_csv</code> e fornecemos
dois argumentos necessários: 1) O argumento “file” (ficheiro) que
especifica a localização da exportação .csv do SISMA e; 2) O argumento
“type” (tipo) que especifica o tipo de dados programático para a
arrumação. Uma lista completa de valores que podem ser passados para o
argumento “type” pode ser encontrada no <code>process_sisma_csv</code>
<a href="https://usaid-mozambique.github.io/sismar/reference/process_sisma_csv.html">documentation</a>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/process_sisma_csv.html">process_sisma_csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="va">path_hiv_tarv</span>, </span>
<span>                        type <span class="op">=</span> <span class="st">"HIV TARV"</span><span class="op">)</span></span></code></pre></div>
<p>Repare-se que o resultado desta função singular é idêntico ao quadro
de dados gerado na abordagem 1! O <code>process_sisma_csv</code> inclui
mais um argumento opcional que define a lingua dos nomes das variáveis
no ficheiro producto. Actualmente as únicas opções de idioma são
“portuguese” e “english” sendo a primeira definida como argumento por
defeito. Ao definir o valor do argumento como “english” observe a
mudança nos nomes das variáveis no quadro de dados resultante.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/process_sisma_csv.html">process_sisma_csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="va">path_hiv_tarv</span>, </span>
<span>                        type <span class="op">=</span> <span class="st">"HIV TARV"</span>,</span>
<span>                        language <span class="op">=</span> <span class="st">"english"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="abordagem-3-utilização-a-nova-função-wrapper-automatizado-recommendado">Abordagem 3: Utilização a nova função “wrapper” automatizado
(recommendado)<a class="anchor" aria-label="anchor" href="#abordagem-3-utiliza%C3%A7%C3%A3o-a-nova-fun%C3%A7%C3%A3o-wrapper-automatizado-recommendado"></a>
</h5>
<p>Já tendo visto como funciona a abordagem 2, pensem como seria
maravilhoso não ter de memorizar ou procurar o argumento “type” para
informar ao <code>sismar</code> que tipo de relatorio está a ser
introduzido. Uma função recém-criada no <code>sismar</code> chamada
<code>process_sisma_export</code> faz exatamente isso, eliminando a
necessidade de definir este argumento. <code>process_sisma_export</code>
detecta automaticamente as colunas presentes na tabela de entrada e, em
seguida, chama o código correcto para criar magicamente a tabela de
dados arrumada. Um exemplo de como isto funciona está abaixo!</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/process_sisma_export.html">process_sisma_export</a></span><span class="op">(</span>file <span class="op">=</span> <span class="va">path_hiv_tarv</span><span class="op">)</span></span></code></pre></div>
<p>Boa análise do seu novo conjunto de dados organizado!</p>
<hr>
<p><em>Disclaimer: The findings, interpretation, and conclusions
expressed herein are those of the authors and do not necessarily reflect
the views of United States Agency for International Development. All
errors remain our own.</em></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Joe Lara, Emilton Cumbana, Karishma Srikanth, Kirstin Lyon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
